<ul>
    {% for item in include.items %}
        {% assign first = item.url | slice: 0 %}

        {% if first == '' %}
            {% assign url = site.baseUrl %}
        {% elsif first == '#' %}
            {% assign url = item.url | prepend: page.url %}
        {%  elsif first == '/' %}
            {%  assign url = item.url %}
        {% else %}
            {% assign url = item.url | prepend: site.baseUrl %}
        {% endif %}

        {% assign pageMatches = false %}
        {%  if page.url == url %}
            {% assign pageMatches = true %}
        {% endif %}

        {% assign keyMatches = false %}
        {%  if page.navKey and item.key and page.navKey == item.key %}
            {% assign keyMatches = true %}
        {% endif %}

        <li {% if pageMatches or keyMatches %}class="current"{% endif %}>
            <a href="{{ url }}">{{ item.title }}</a>
            {% if item.children %}
                {%  include nav-inner.html.liquid items=item.children %}
            {% endif %}
        </li>
    {% endfor %}
</ul>